topo_relations:
  -
    type: host
    dependingitems:
      -
        id: connect
        layer: indirect
        toTypes:
          -
            type: host
  -
    type: system_proc
    dependingitems:
      -
        id: runs_on
        layer: direct
        toTypes:
          -
            type: host
            matches:
              -
                from: machine_id
                to: machine_id
      -
        id: belongs_to
        layer: direct
        toTypes:
          -
            type: appinstance
            matches:
              -
                from: pgid
                to: pgid
              -
                from: machine_id
                to: machine_id
      -
        id: belongs_to
        layer: direct
        toTypes:
          -
            type: container
            matches:
              -
                from: tgid
                to: proc_id
              -
                from: machine_id
                to: machine_id
      -
        id: connect
        layer: indirect
        toTypes:
          -
            type: system_proc
  -
    type: thread
    dependingitems:
      -
        id: belongs_to
        layer: direct
        toTypes:
          -
            type: system_proc
            matches:
              -
                from: tgid
                to: tgid
              -
                from: machine_id
                to: machine_id
  -
    type: bind
    dependingitems:
      -
        id: belongs_to
        layer: direct
        toTypes:
          -
            type: system_proc
            matches:
              -
                from: tgid
                to: tgid
              -
                from: machine_id
                to: machine_id
  -
    type: udp
    dependingitems:
      -
        id: belongs_to
        layer: direct
        toTypes:
          -
            type: system_proc
            matches:
              -
                from: tgid
                to: tgid
              -
                from: machine_id
                to: machine_id
  -
    type: connect
    dependingitems:
      -
        id: belongs_to
        layer: direct
        toTypes:
          -
            type: system_proc
            matches:
              -
                from: tgid
                to: tgid
              -
                from: machine_id
                to: machine_id
  -
    type: listen
    dependingitems:
      -
        id: belongs_to
        layer: direct
        toTypes:
          -
            type: system_proc
            matches:
              -
                from: tgid
                to: tgid
              -
                from: machine_id
                to: machine_id
  -
    type: tcp_link
    dependingitems:
      -
        id: belongs_to
        layer: direct
        toTypes:
          -
            type: system_proc
            matches:
              -
                from: tgid
                to: tgid
              -
                from: machine_id
                to: machine_id
      -
        id: is_peer
        layer: direct
        toTypes:
          -
            type: tcp_link
            matches:
              -
                from: server_ip
                to: server_ip
              -
                from: server_port
                to: server_port
              -
                from: client_ip
                to: client_ip
              -
                from: client_port
                to: client_port
            conflicts:
              -
                from: role
                to: role
  -
    type: ksliprobe
    dependingitems:
      -
        id: belongs_to
        layer: direct
        toTypes:
          -
            type: system_proc
            matches:
              -
                from: tgid
                to: tgid
              -
                from: machine_id
                to: machine_id
  -
    type: system_cpu
    dependingitems:
      -
        id: belongs_to
        layer: direct
        toTypes:
          -
            type: host
            matches:
              -
                from: machine_id
                to: machine_id
  -
    type: system_net
    dependingitems:
      -
        id: belongs_to
        layer: direct
        toTypes:
          -
            type: host
            matches:
              -
                from: machine_id
                to: machine_id
  -
    type: system_iostat
    dependingitems:
      -
        id: belongs_to
        layer: direct
        toTypes:
          -
            type: host
            matches:
              -
                from: machine_id
                to: machine_id
  -
    type: block
    dependingitems:
      -
        id: belongs_to
        layer: direct
        toTypes:
          -
            type: system_iostat
            matches:
              -
                from: disk_name
                to: disk_name
              -
                from: machine_id
                to: machine_id
